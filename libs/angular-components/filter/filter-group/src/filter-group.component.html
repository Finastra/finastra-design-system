<mat-expansion-panel
  #filterGroupPanel
  class="uxg-filter-group"
  hideToggle="true"
  [expanded]="expanded"
  [class.active]="checkIsActive()"
>
  <mat-expansion-panel-header [expandedHeight]="'48px'">
    <div class="uxg-filter-group-header" (click)="$event.preventDefault(); $event.stopPropagation()">
      <div class="selectedFilters">
        <ng-container *ngFor="let filter of selectedData; let i = index">
          <div
            *ngIf="filter.selectedData.length && !filter.selectedData[0].value"
            matBadge="{{ filter.selectedData.length }}"
            class="uxg-group-filter uxg-side-badge"
          >
            {{ filter.title }}
          </div>
          <div *ngIf="!filter.selectedData.length" matBadge="All" class="uxg-group-filter uxg-side-badge">
            {{ filter.title }}
          </div>
          <div
            *ngIf="filter.selectedData.length && filter.selectedData[0].value"
            class="uxg-group-filter uxg-side-badge"
          >
            {{ filter.title }}: <span class="filter-value">{{ filter.selectedData[0].label }}</span>
          </div>
          <mat-divider *ngIf="checkDivider(i)" class="filter-divider" vertical></mat-divider>
        </ng-container>
      </div>
      <span class="fill-remaining-space"></span>
      <button
        mat-icon-button
        color="primary"
        dense
        (click)="filterGroupPanel.toggle(); filterGroupPanel.expanded ? open() : close()"
      >
        <mat-icon *ngIf="!filterGroupPanel.expanded">arrow_drop_down</mat-icon>
        <mat-icon *ngIf="filterGroupPanel.expanded">arrow_drop_up</mat-icon>
      </button>
    </div>
  </mat-expansion-panel-header>

  <div class="expansion-panel-header">
    <div class="header-title">
      <span>Filter by</span>
    </div>

    <button mat-button color="accent" dense (click)="resetSelection()">
      <mat-icon>refresh</mat-icon>
      Reset
    </button>
  </div>

  <div class="expansion-panel-content" fxLayout="row wrap" fxLayoutAlign="start">
    <ng-content> </ng-content>
  </div>
  <mat-divider></mat-divider>
  <div class="expansion-panel-actions" fxLayout="row wrap">
    <div class="saved-filters-container">
      <mat-chip-list #savedFiltersList>
        <mat-chip
          *ngFor="let filter of savedFilters"
          large
          removable
          (click)="selectFilter(filter)"
          [selected]="filter.isSelected"
          (removed)="removeFilter(filter)"
        >
          {{ filter.filterName }}
          <mat-icon matChipRemove>cancel</mat-icon>
        </mat-chip>
      </mat-chip-list>
    </div>

    <button *ngIf="savedFilters.length" mat-button color="accent" (click)="updateFilter()">Update</button>
    <button *ngIf="savedFilters.length" mat-button color="accent" (click)="clearFilter()">Clear</button>
    <mat-divider vertical="true"></mat-divider>
    <button mat-stroked-button color="accent" (click)="openDialog()">Save as</button>
    <button mat-stroked-button color="accent" (click)="filterGroupPanel.toggle(); close()">Cancel</button>
    <button mat-stroked-button color="accent" (click)="applyFilters()">Apply</button>
  </div>
</mat-expansion-panel>
